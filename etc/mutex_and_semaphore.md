# 뮤텍스 & 세마포어

자원에 대한 동시성 접근제어시, 개념이 나올때마다 헷갈려서 이참에 정리함.<br/>개략적인 이해를 위해 예시를 들어 정리한 글이므로, 프로그래밍 적으로 완전히 정확하지 않을 수 있음을 감안할 것.

### 뮤텍스(MUTual EXclusion, 상호배제)

1. 양꼬치 집에서 술을 마시다가 화장실이 급해졌다. 
2. 화장실은 평소에 잠겨있고, 사용하기 위해서는 열쇠가 필요하다.
3. 화장실이 한 개 밖에 없어서, 한 명씩만 사용 가능하다.
4. 열쇠가 없으면, 열쇠가 반납될때까지 대기한다. **화장실을 선점한 사용자가 스스로나올 때까지 무조건 대기한다**
5. 양꼬치 집의 화장실 접근 제한 방식은 뮤텍스이다.

\* 이 때, 극단적인 예로, 만약 화장실에 들어간 사람이 일을 보다가 죽어버리면, 밖에서 대기하는 사람은 무한 대기상태에 빠진다. <br/>이를 교착상태, 데드락(DeadLock)이라 한다.

### 세마포어

1. 양꼬치 집 사장님은 화장실 이용자가 생각보다 많다는 것을 깨닫고, 화장실을 3개로 늘렸다.
2. 이제 열쇠는 세 개 이며, 열쇠가 0개가 아닌 이상 세 명 까지는 동시에 화장실 이용이 가능하다.
3. 열쇠가 0개라면, 마찬가지로 대기하지만, **무조건 대기하는 것이 아닌, 노크를 통해 열쇠의 반납을 요구할 수 있다**
4. 이제 양꼬치 집의 화장실 접근 제한 방식은 세마포어이다.


### 정리

1. 화장실은 '자원'이다.
2. 화장실 이용자는 '프로세스'이다.
3. 뮤텍스와 세마포어는 결국 자원(화장실)에 대한 프로세스(이용자)의 접근 제어를 위한 기술이다
4. 뮤텍스는 특정 자원을 오직 한 프로세스만이 접근 가능하도록 제어하는 기술이다.
5. 세마포어는 특정 자원을 동시에 특정 갯수의 프로세스가 접근 가능하도록 제어하는 기술이다.
	- 만약, 세마포어가 특정 자원을 동시에 한 개의 프로세스만 접근 가능하도록 제어한다면 이는 바이너리 세마포어라 부르며, 뮤텍스와 '비슷해'진다.
		- 뮤텍스는 자원을 선점한 프로세스가 직접 락을 해제(열쇠를 반납)하기 전에는 무조건 대기해야한다.
		- 세마포어는 자원을 선점한 프로세스가 직접 락을 해제하지 않더라도, 다른 프로세스가 락의 해제를 요청할 수 있다.



